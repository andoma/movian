OS X: Improve full screen support and fix various related bugs
